{
  "model620cat": {
    "description": "Estructura de datos para el Impuesto (Modelo 620 - Catalunya) basada en el formulario PDF y el mapeo de campos en `database_fields.md`.",
    "metadata": {
      "source": "tax_models/mod620cat/mod620cat.pdf",
      "formCode": "620",
      "jurisdiction": "Catalonia",
      "language": "ca-ES",
      "lastUpdated": "2025-12-18"
    },
    "structure": [
      {
        "id": "encabezado",
        "label": "Encabezado",
        "order": 0,
        "required": false,
        "fields": []
      },
      {
        "id": "contribuyente",
        "label": "Contribuyente",
        "order": 1,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF del contribuyente",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "NIF/NIE/CIF del contribuyente (BD: persona.dni_nif).",
            "validation": "Debe ser un DNI, NIE o CIF v\u00e1lido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$"
          },
          {
            "id": "nombre_completo",
            "label": "Nombre y apellidos",
            "type": "string",
            "order": 2,
            "required": false,
            "description": "Apellidos y nombre del contribuyente (BD: persona.nombre + persona.apellidos)."
          },
          {
            "id": "telefono",
            "label": "Tel\u00e9fono",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Tel\u00e9fono de contacto (BD: persona.telefono)."
          },
          {
            "id": "direccion_electronica",
            "label": "Direccion electronica",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Direccion electronica del contribuyente (BD: persona.email)."
          }
        ]
      },
      {
        "id": "transmitente",
        "label": "Transmitente",
        "order": 2,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF del transmitente",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "NIF/NIE/CIF del transmitente (BD: persona.dni_nif si aplica).",
            "validation": "Debe ser un DNI, NIE o CIF v\u00e1lido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$"
          },
          {
            "id": "nombre_completo_razon_social",
            "label": "Nombre / Raz\u00f3n social",
            "type": "string",
            "order": 2,
            "required": false,
            "description": "Nombre y apellidos o raz\u00f3n social del transmitente (BD: persona.nombre + persona.apellidos si es persona)."
          },
          {
            "id": "telefono",
            "label": "Tel\u00e9fono",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Tel\u00e9fono del transmitente (BD: persona.telefono si aplica)."
          },
          {
            "id": "direccion_electronica",
            "label": "Direccion electronica",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Direccion electronica del transmitente (BD: persona.email si aplica)."
          }
        ]
      },
      {
        "id": "devengo",
        "label": "Devengo / Adquisici\u00f3n",
        "order": 3,
        "required": true,
        "fields": [
          {
            "id": "fecha_devengo",
            "label": "Fecha de devengo",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "Fecha de devengo (formato ISO YYYY-MM-DD).",
            "format": "date",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          {
            "id": "adquisicion_porcentaje",
            "label": "Porcentaje de adquisici\u00f3n",
            "type": "number",
            "order": 2,
            "required": false,
            "description": "Porcentaje de adquisici\u00f3n (0-100).",
            "format": "decimal"
          }
        ]
      },
      {
        "id": "bien",
        "label": "Tipo de bien",
        "order": 4,
        "required": true,
        "fields": [
          {
            "id": "tipo_bien",
            "label": "Tipo de bien",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "Tipo de bien transmitido. Debe ser uno de: 'vehiculo', 'embarcacion', 'aeronave'.",
            "options": [
              "vehiculo",
              "embarcacion",
              "aeronave"
            ]
          },
          {
            "id": "es_vehiculo",
            "label": "Veh\u00edculo",
            "type": "boolean",
            "order": 2,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_bien == 'vehiculo'.",
            "calculation": "tipo_bien == 'vehiculo'"
          },
          {
            "id": "es_embarcacion",
            "label": "Embarcaci\u00f3n",
            "type": "boolean",
            "order": 3,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_bien == 'embarcacion'.",
            "calculation": "tipo_bien == 'embarcacion'"
          },
          {
            "id": "es_aeronave",
            "label": "Aeronave",
            "type": "boolean",
            "order": 4,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_bien == 'aeronave'.",
            "calculation": "tipo_bien == 'aeronave'"
          }
        ]
      },
      {
        "id": "vehiculo",
        "label": "Veh\u00edculo (si aplica)",
        "order": 5,
        "required": false,
        "fields": [
          {
            "id": "anyo_fabricacion",
            "label": "A\u00f1o de fabricaci\u00f3n",
            "type": "number",
            "order": 1,
            "required": false,
            "format": "integer"
          },
          {
            "id": "fecha_primera_matriculacion",
            "label": "Fecha 1\u00aa matriculaci\u00f3n",
            "type": "string",
            "order": 2,
            "required": false,
            "format": "date",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          {
            "id": "numero_matricula",
            "label": "Matr\u00edcula",
            "type": "string",
            "order": 3,
            "required": false
          },
          {
            "id": "tipo_vehiculo",
            "label": "Tipo de veh\u00edculo",
            "type": "string",
            "order": 4,
            "required": false
          },
          {
            "id": "marca",
            "label": "Marca",
            "type": "string",
            "order": 5,
            "required": false
          },
          {
            "id": "modelo",
            "label": "Modelo",
            "type": "string",
            "order": 6,
            "required": false
          },
          {
            "id": "potencia",
            "label": "Potencia",
            "type": "number",
            "order": 7,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "bastidor",
            "label": "N\u00ba de bastidor",
            "type": "string",
            "order": 8,
            "required": false
          },
          {
            "id": "cilindrada",
            "label": "Cilindrada",
            "type": "number",
            "order": 9,
            "required": false,
            "format": "decimal"
          }
        ]
      },
      {
        "id": "embarcacion",
        "label": "Embarcaci\u00f3n (si aplica)",
        "order": 6,
        "required": false,
        "fields": [
          {
            "id": "marca",
            "label": "Marca",
            "type": "string",
            "order": 1,
            "required": false
          },
          {
            "id": "modelo",
            "label": "Modelo",
            "type": "string",
            "order": 2,
            "required": false
          },
          {
            "id": "eslora",
            "label": "Eslora",
            "type": "number",
            "order": 3,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "vela",
            "label": "Vela",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Campo del PDF relacionado con 'Vela' (interpretaci\u00f3n depende del formulario)."
          },
          {
            "id": "numero_motores",
            "label": "N\u00ba de motores",
            "type": "number",
            "order": 5,
            "required": false,
            "format": "integer"
          },
          {
            "id": "cv",
            "label": "CV",
            "type": "number",
            "order": 6,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "fecha_fabricacion_motores",
            "label": "Fecha fabricaci\u00f3n motores",
            "type": "string",
            "order": 7,
            "required": false,
            "format": "date",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          {
            "id": "tipo_motor",
            "label": "Tipo de motor",
            "type": "string",
            "order": 8,
            "required": false,
            "description": "Tipo de motor de la embarcaci\u00f3n. Debe ser uno de: 'diesel', 'gasolina', 'otros'.",
            "options": [
              "diesel",
              "gasolina",
              "otros"
            ]
          },
          {
            "id": "motor_diesel",
            "label": "Di\u00e9sel",
            "type": "boolean",
            "order": 9,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_motor == 'diesel'.",
            "calculation": "tipo_motor == 'diesel'"
          },
          {
            "id": "motor_gasolina",
            "label": "Gasolina",
            "type": "boolean",
            "order": 10,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_motor == 'gasolina'.",
            "calculation": "tipo_motor == 'gasolina'"
          },
          {
            "id": "motor_otros",
            "label": "Otros",
            "type": "boolean",
            "order": 11,
            "required": false,
            "description": "Checkbox del PDF. Recomendaci\u00f3n: derivar como tipo_motor == 'otros'.",
            "calculation": "tipo_motor == 'otros'"
          }
        ]
      },
      {
        "id": "aeronave",
        "label": "Aeronave (si aplica)",
        "order": 7,
        "required": false,
        "fields": [
          {
            "id": "marca",
            "label": "Marca",
            "type": "string",
            "order": 1,
            "required": false
          },
          {
            "id": "modelo",
            "label": "Modelo",
            "type": "string",
            "order": 2,
            "required": false
          },
          {
            "id": "peso",
            "label": "Peso",
            "type": "number",
            "order": 3,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "numero_motores",
            "label": "N\u00ba de motores",
            "type": "number",
            "order": 4,
            "required": false,
            "format": "integer"
          },
          {
            "id": "marca_motor",
            "label": "Marca del motor",
            "type": "string",
            "order": 5,
            "required": false
          },
          {
            "id": "potencia",
            "label": "Potencia",
            "type": "number",
            "order": 6,
            "required": false,
            "format": "decimal"
          }
        ]
      },
      {
        "id": "exenciones",
        "label": "Exenciones / No sujeci\u00f3n",
        "order": 8,
        "required": false,
        "fields": [
          {
            "id": "exento",
            "label": "Exento",
            "type": "boolean",
            "order": 1,
            "required": false
          },
          {
            "id": "no_sujeto",
            "label": "No sujeto",
            "type": "boolean",
            "order": 2,
            "required": false
          },
          {
            "id": "no_sujecion_1",
            "label": "Motivo no sujeci\u00f3n (1)",
            "type": "string",
            "order": 3,
            "required": false
          },
          {
            "id": "no_sujecion_2",
            "label": "Motivo no sujeci\u00f3n (2)",
            "type": "string",
            "order": 4,
            "required": false
          },
          {
            "id": "no_sujecion_3",
            "label": "Motivo no sujeci\u00f3n (3)",
            "type": "string",
            "order": 5,
            "required": false
          }
        ]
      },
      {
        "id": "liquidacion",
        "label": "Liquidaci\u00f3n",
        "order": 9,
        "required": true,
        "fields": [
          {
            "id": "base_imponible",
            "label": "Base imponible",
            "type": "number",
            "order": 1,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "gravamen",
            "label": "Gravamen",
            "type": "number",
            "order": 2,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "cuota_tributaria",
            "label": "Cuota tributaria",
            "type": "number",
            "order": 3,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "cuota_ingresada",
            "label": "Cuota ingresada",
            "type": "number",
            "order": 4,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "recargo",
            "label": "Recargo",
            "type": "number",
            "order": 5,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "intereses_demora",
            "label": "Intereses de demora",
            "type": "number",
            "order": 6,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "total",
            "label": "Total",
            "type": "number",
            "order": 7,
            "required": false,
            "format": "decimal"
          },
          {
            "id": "liquidacion_complementaria",
            "label": "Liquidaci\u00f3n complementaria",
            "type": "boolean",
            "order": 8,
            "required": false
          },
          {
            "id": "numero_liquidacion_complementaria",
            "label": "N\u00famero de 1\u00aa liquidaci\u00f3n",
            "type": "string",
            "order": 9,
            "required": false
          }
        ]
      },
      {
        "id": "pago",
        "label": "Pago",
        "order": 10,
        "required": true,
        "fields": [
          {
            "id": "cargo_en_cuenta",
            "label": "Cargo en cuenta",
            "type": "boolean",
            "order": 1,
            "required": false
          },
          {
            "id": "pago_efectivo",
            "label": "Efectivo",
            "type": "boolean",
            "order": 2,
            "required": false
          },
          {
            "id": "iban",
            "label": "IBAN",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "IBAN completo (si se proporciona, puede derivar pa\u00eds/DC/entidad/sucursal/d\u00edgitos control/cuenta).",
            "validationRegex": "^ES\\d{22}$"
          },
          {
            "id": "pais_banco",
            "label": "Pa\u00eds",
            "type": "string",
            "order": 4,
            "required": false,
            "default": "ES",
            "validationRegex": "^[A-Z]{2}$"
          },
          {
            "id": "dc_iban",
            "label": "DC (IBAN)",
            "type": "string",
            "order": 5,
            "required": false,
            "validationRegex": "^\\d{2}$"
          },
          {
            "id": "entidad_banco",
            "label": "Entidad",
            "type": "string",
            "order": 6,
            "required": false,
            "validationRegex": "^\\d{4}$"
          },
          {
            "id": "sucursal_banco",
            "label": "Sucursal",
            "type": "string",
            "order": 7,
            "required": false,
            "validationRegex": "^\\d{4}$"
          },
          {
            "id": "digitos_control_banco",
            "label": "D\u00edgitos de control",
            "type": "string",
            "order": 8,
            "required": false,
            "validationRegex": "^\\d{2}$"
          },
          {
            "id": "numero_cuenta",
            "label": "Cuenta",
            "type": "string",
            "order": 9,
            "required": false,
            "validationRegex": "^\\d{10}$"
          }
        ]
      },
      {
        "id": "presentacion",
        "label": "Presentaci\u00f3n",
        "order": 11,
        "required": true,
        "fields": [
          {
            "id": "fecha_presentacion",
            "label": "Fecha de presentaci\u00f3n",
            "type": "string",
            "order": 1,
            "required": false,
            "format": "date",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          {
            "id": "dia_presentacion",
            "label": "D\u00eda",
            "type": "string",
            "order": 2,
            "required": false,
            "description": "D\u00eda de la fecha de presentaci\u00f3n (derivable desde fecha_presentacion).",
            "calculation": "day(fecha_presentacion)"
          },
          {
            "id": "mes_presentacion",
            "label": "Mes",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Mes de la fecha de presentaci\u00f3n (derivable desde fecha_presentacion).",
            "calculation": "month(fecha_presentacion)"
          },
          {
            "id": "anyo_presentacion",
            "label": "A\u00f1o",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "A\u00f1o de la fecha de presentaci\u00f3n (derivable desde fecha_presentacion).",
            "calculation": "year(fecha_presentacion)"
          },
          {
            "id": "lugar",
            "label": "Lugar",
            "type": "string",
            "order": 5,
            "required": false
          }
        ]
      },
      {
        "id": "presentador",
        "label": "Presentador",
        "order": 12,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF del presentador",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "NIF/NIE/CIF del presentador (BD: persona.dni_nif si aplica).",
            "validation": "Debe ser un DNI, NIE o CIF v\u00e1lido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$"
          },
          {
            "id": "nombre_completo",
            "label": "Nombre y apellidos",
            "type": "string",
            "order": 2,
            "required": false,
            "description": "Apellidos y nombre del presentador (BD: persona.nombre + persona.apellidos)."
          },
          {
            "id": "telefono",
            "label": "Tel\u00e9fono",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Tel\u00e9fono del presentador (BD: persona.telefono)."
          },
          {
            "id": "direccion_electronica",
            "label": "Direccion electronica",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Direccion electronica del presentador (BD: persona.email)."
          }
        ]
      }
    ],
    "notes": {
      "ordering": "Las secciones siguen el orden habitual del formulario del Modelo 620 (contribuyente, transmitente, devengo, bien, exenciones/no sujeci\u00f3n, liquidaci\u00f3n, pago, presentaci\u00f3n, presentador).",
      "fieldMappings": "Las coordenadas de los campos est\u00e1n en tax_models/mod620cat/data_models/mod620cat_field_mappings.json.",
      "conditionalSections": "Solo uno de 'vehiculo', 'embarcacion' o 'aeronave' deber\u00eda rellenarse seg\u00fan `bien.tipo_bien`. En embarcaci\u00f3n, solo uno de motor_diesel/motor_gasolina/motor_otros deber\u00eda ser true seg\u00fan `embarcacion.tipo_motor`.",
      "idNaming": "Los IDs de campos no incluyen prefijos; el contexto lo aporta la secci\u00f3n padre. Los nombres usan snake_case y, cuando existe en BD, se alinean con `database_fields.md` (ej: dni_nif, telefono, linea_direccion)."
    }
  }
}
