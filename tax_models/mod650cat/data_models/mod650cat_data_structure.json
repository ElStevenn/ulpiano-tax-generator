{
  "model650cat": {
    "description": "Estructura de datos ordenada para la declaración del impuesto de sucesiones específica de Cataluña (Modelo 650 - ATC-650E-6).",
    "metadata": {
      "source": "tax_models/650_es-cat.pdf",
      "formCode": "ATC-650E-6",
      "jurisdiction": "Catalonia",
      "language": "es-CA",
      "lastUpdated": "2025-11-17"
    },
    "structure": [
      {
        "id": "encabezado",
        "label": "Encabezado",
        "order": 0,
        "required": false,
        "fields": []
      },
      {
        "id": "causante",
        "label": "Causante",
        "order": 1,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF del causante",
            "type": "string",
            "order": 1,
            "required": false,
            "description": "NIF/NIE de la persona causante.",
            "validation": "Debe ser un DNI, NIE o CIF válido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$"
          },
          {
            "id": "nombre_completo",
            "label": "Nombre completo del causante",
            "type": "string",
            "order": 2,
            "required": false,
            "description": "Nombre completo del causante (Apellidos y nombre)."
          },
          {
            "id": "nombre_via",
            "label": "Nombre de la vía",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Calle o vía utilizada en la dirección postal (Vía pública)."
          },
          {
            "id": "numero_via",
            "label": "Número de la vía",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Número de casa o edificio mostrado antes de Esc./Piso/Puerta."
          },
          {
            "id": "escalera",
            "label": "Escalera / bloque",
            "type": "string",
            "order": 5,
            "required": false,
            "description": "Escalera, bloque o entrada (Esc.)."
          },
          {
            "id": "piso",
            "label": "Piso",
            "type": "string",
            "order": 6,
            "required": false,
            "description": "Información del piso (Piso)."
          },
          {
            "id": "puerta",
            "label": "Puerta / unidad",
            "type": "string",
            "order": 7,
            "required": false,
            "description": "Número de puerta o identificador de unidad (Puerta)."
          },
          {
            "id": "codigo_postal",
            "label": "Código postal",
            "type": "string",
            "order": 8,
            "required": false,
            "description": "Código postal junto al bloque de dirección.",
            "validation": "Debe contener exactamente 5 dígitos.",
            "validationRegex": "^\\d{5}$"
          },
          {
            "id": "municipio",
            "label": "Municipio",
            "type": "string",
            "order": 9,
            "required": false,
            "description": "Nombre del municipio o ciudad."
          },
          {
            "id": "provincia",
            "label": "Provincia",
            "type": "string",
            "order": 10,
            "required": false,
            "description": "Nombre de la provincia (Provincia)."
          },
          {
            "id": "pais",
            "label": "País",
            "type": "string",
            "order": 11,
            "required": false,
            "description": "Código de país impreso bajo País.",
            "default": "ES"
          },
          {
            "id": "obligado_impuesto_patrimonio_ultimos_cuatro_anos",
            "label": "Estaba obligado al impuesto sobre el patrimonio en los últimos 4 años",
            "type": "boolean",
            "order": 12,
            "required": false,
            "description": "Corresponde a la pregunta 'Persona causante obligada a presentar declaración del impuesto sobre el patrimonio en alguno de los 4 años anteriores a la muerte?'. Casilla marcada con X para 'Sí'."
          },
          {
            "id": "es_testamentaria",
            "label": "La sucesión es testamentaria (con testamento)",
            "type": "boolean",
            "order": 13,
            "required": false,
            "description": "Casilla para 'testada' (sucesión testamentaria, es decir, con testamento)."
          },
          {
            "id": "es_intestada",
            "label": "La sucesión es intestada (sin testamento)",
            "type": "boolean",
            "order": 14,
            "required": false,
            "description": "Casilla para 'intestada' (sucesión intestada, es decir, sin testamento)."
          },
          {
            "id": "numero_personas_interesadas",
            "label": "Número de personas interesadas",
            "type": "number",
            "order": 15,
            "required": true,
            "description": "Número de personas interesadas en la sucesión.",
            "format": "integer",
            "validation": "Debe ser mayor o igual a 1."
          },
          {
            "id": "notario_o_autoridad",
            "label": "Notario o autoridad",
            "type": "string",
            "order": 16,
            "required": false,
            "description": "Nombre del notario o autoridad competente (Notario/aria o autoridad)."
          },
          {
            "id": "fecha_acta_notarial",
            "label": "Fecha del acta notarial",
            "type": "string",
            "order": 17,
            "required": false,
            "description": "Fecha mostrada junto al bloque Notario/autoridad (//).",
            "format": "YYYY-MM-DD",
            "validation": "Debe ser una fecha válida en formato ISO (YYYY-MM-DD).",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          }
        ]
      },
      {
        "id": "beneficiario",
        "label": "Beneficiario",
        "order": 2,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF (caja 2)",
            "type": "string",
            "order": 1,
            "required": true,
            "description": "Número de identificación fiscal español impreso junto a la caja (2).",
            "validation": "Debe ser un DNI, NIE o CIF válido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$",
            "boxNumber": "2"
          },
          {
            "id": "nombre_completo_razon_social",
            "label": "Nombre completo o razón social",
            "type": "string",
            "order": 2,
            "required": true,
            "description": "Nombre legal completo del beneficiario (o el nombre de la empresa cuando actúa como entidad)."
          },
          {
            "id": "nombre_via",
            "label": "Nombre de la vía",
            "type": "string",
            "order": 3,
            "required": true,
            "description": "Calle o vía utilizada en la dirección postal (Vía pública)."
          },
          {
            "id": "numero_via",
            "label": "Número de la vía",
            "type": "string",
            "order": 4,
            "required": true,
            "description": "Número de casa o edificio mostrado antes de Esc./Piso/Puerta."
          },
          {
            "id": "escalera",
            "label": "Escalera / bloque",
            "type": "string",
            "order": 5,
            "required": false,
            "description": "Escalera, bloque o entrada (Esc.)."
          },
          {
            "id": "piso",
            "label": "Piso",
            "type": "string",
            "order": 6,
            "required": false,
            "description": "Información del piso (Piso)."
          },
          {
            "id": "puerta",
            "label": "Puerta / unidad",
            "type": "string",
            "order": 7,
            "required": false,
            "description": "Número de puerta o identificador de unidad (Puerta)."
          },
          {
            "id": "codigo_postal",
            "label": "Código postal",
            "type": "string",
            "order": 8,
            "required": true,
            "description": "Código postal junto al bloque de dirección.",
            "validation": "Debe contener exactamente 5 dígitos.",
            "validationRegex": "^\\d{5}$"
          },
          {
            "id": "municipio",
            "label": "Municipio",
            "type": "string",
            "order": 9,
            "required": true,
            "description": "Nombre del municipio o ciudad."
          },
          {
            "id": "provincia",
            "label": "Provincia",
            "type": "string",
            "order": 10,
            "required": true,
            "description": "Nombre de la provincia (Provincia)."
          },
          {
            "id": "pais",
            "label": "País",
            "type": "string",
            "order": 11,
            "required": false,
            "description": "Código de país impreso bajo País.",
            "default": "ES"
          },
          {
            "id": "telefono",
            "label": "Número de teléfono (caja 3)",
            "type": "string",
            "order": 12,
            "required": false,
            "description": "Contacto telefónico mostrado en la caja (3).",
            "recommended": true,
            "boxNumber": "3"
          },
          {
            "id": "correo_electronico",
            "label": "Dirección de correo electrónico",
            "type": "string",
            "order": 13,
            "required": false,
            "description": "Dirección de correo electrónico (Dirección electrónica).",
            "recommended": true
          },
          {
            "id": "fecha_nacimiento",
            "label": "Fecha de nacimiento (caja 4)",
            "type": "string",
            "order": 14,
            "required": true,
            "description": "Fecha de nacimiento solicitada en la caja (4).",
            "format": "YYYY-MM-DD",
            "validation": "Debe ser una fecha válida en formato ISO (YYYY-MM-DD).",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$",
            "boxNumber": "4"
          },
          {
            "id": "parentesco",
            "label": "Parentesco",
            "type": "string",
            "order": 15,
            "required": true,
            "description": "Parentesco con el causante (Parentesco)."
          },
          {
            "id": "grupo_parentesco",
            "label": "Grupo de parentesco",
            "type": "string",
            "order": 16,
            "required": true,
            "description": "Grupo fiscal solicitado junto a Parentesco (Grupo).",
            "values": [
              "I",
              "II",
              "III",
              "IV"
            ]
          },
          {
            "id": "patrimonio_preexistente",
            "label": "Patrimonio preexistente",
            "type": "number",
            "order": 17,
            "required": false,
            "description": "Importe ingresado en Patrimonio preexistente (EUR).",
            "format": "decimal"
          },
          {
            "id": "tiene_discapacidad",
            "label": "Tiene discapacidad",
            "type": "boolean",
            "order": 18,
            "required": false,
            "description": "Casilla que indica si el beneficiario tiene discapacidad (Discapacidad: Sí)."
          },
          {
            "id": "porcentaje_discapacidad",
            "label": "Porcentaje de discapacidad",
            "type": "number",
            "order": 19,
            "required": false,
            "description": "Porcentaje escrito junto a la casilla de discapacidad.",
            "format": "decimal",
            "validation": "Debe ser un valor entre 0 y 100.",
            "dependsOn": "tiene_discapacidad"
          },
          {
            "id": "titulo_sucesorio",
            "label": "Título sucesorio",
            "type": "string",
            "order": 20,
            "required": false,
            "description": "Título legal de la sucesión (Título sucesorio)."
          },
          {
            "id": "pago",
            "label": "Pago",
            "type": "object",
            "order": 21,
            "required": true,
            "fields": [
              {
                "id": "pagoIban",
                "label": "IBAN",
                "type": "string",
                "order": 1,
                "required": false,
                "description": "Código IBAN completo para el cargo/pago.",
                "validationRegex": "^[A-Z]{2}\\d{2}[A-Z0-9]{4,30}$"
              },
              {
                "id": "pagoCargoEnCuenta",
                "label": "Cargo en cuenta",
                "type": "boolean",
                "order": 2,
                "required": false,
                "description": "Casilla 'Cargo en cuenta'."
              },
              {
                "id": "pagoPagoEfectivo",
                "label": "Pago en efectivo",
                "type": "boolean",
                "order": 3,
                "required": false,
                "description": "Casilla 'En efectivo'."
              },
              {
                "id": "pagoPaisBanco",
                "label": "País del banco",
                "type": "string",
                "order": 4,
                "required": false,
                "description": "Código de país (ES).",
                "default": "ES"
              },
              {
                "id": "pagoDigitosControlBanco",
                "label": "DC",
                "type": "string",
                "order": 5,
                "required": false,
                "description": "Dígitos de control (primer DC)."
              },
              {
                "id": "pagoEntidadBanco",
                "label": "Entidad",
                "type": "string",
                "order": 6,
                "required": false,
                "description": "Código de entidad (4 dígitos).",
                "validationRegex": "^\\d{4}$"
              },
              {
                "id": "pagoSucursalBanco",
                "label": "Sucursal",
                "type": "string",
                "order": 7,
                "required": false,
                "description": "Código de sucursal (4 dígitos).",
                "validationRegex": "^\\d{4}$"
              },
              {
                "id": "pagoDigitosControlBanco2",
                "label": "DC2",
                "type": "string",
                "order": 8,
                "required": false,
                "description": "Segundo DC."
              },
              {
                "id": "pagoNumeroCuenta",
                "label": "Número de cuenta",
                "type": "string",
                "order": 9,
                "required": false,
                "description": "Cuenta (10 dígitos).",
                "validationRegex": "^\\d{10}$"
              },
              {
                "id": "pagoImporte",
                "label": "Importe",
                "type": "number",
                "order": 10,
                "required": false,
                "description": "Importe del pago en EUR.",
                "format": "decimal"
              }
            ]
          }
        ]
      },
      {
        "id": "tramitante",
        "label": "Tramitante",
        "order": 3,
        "required": true,
        "fields": [
          {
            "id": "dni_nif",
            "label": "NIF del firmante",
            "type": "string",
            "order": 1,
            "required": true,
            "description": "NIF impreso junto a la declaración firmada por el tramitante o presentador.",
            "validation": "Debe ser un DNI, NIE o CIF válido.",
            "validationRegex": "^[0-9XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$|^[XYZ][0-9]{7}[A-Z]$|^[ABCDEFGHJNPQRSUVW][0-9]{7}[0-9A-J]$"
          },
          {
            "id": "nombre_completo_firmante",
            "label": "Nombre completo del firmante",
            "type": "string",
            "order": 2,
            "required": true,
            "description": "Nombre de la persona que firma la declaración."
          },
          {
            "id": "nombre_via",
            "label": "Nombre de la vía",
            "type": "string",
            "order": 3,
            "required": false,
            "description": "Calle o vía utilizada en la dirección postal (Vía pública)."
          },
          {
            "id": "numero_via",
            "label": "Número de la vía",
            "type": "string",
            "order": 4,
            "required": false,
            "description": "Número de casa o edificio mostrado antes de Esc./Piso/Puerta."
          },
          {
            "id": "escalera",
            "label": "Escalera / bloque",
            "type": "string",
            "order": 5,
            "required": false,
            "description": "Escalera, bloque o entrada (Esc.)."
          },
          {
            "id": "piso",
            "label": "Piso",
            "type": "string",
            "order": 6,
            "required": false,
            "description": "Información del piso (Piso)."
          },
          {
            "id": "puerta",
            "label": "Puerta / unidad",
            "type": "string",
            "order": 7,
            "required": false,
            "description": "Número de puerta o identificador de unidad (Puerta)."
          },
          {
            "id": "codigo_postal",
            "label": "Código postal",
            "type": "string",
            "order": 8,
            "required": false,
            "description": "Código postal junto al bloque de dirección.",
            "validation": "Debe contener exactamente 5 dígitos.",
            "validationRegex": "^\\d{5}$"
          },
          {
            "id": "municipio",
            "label": "Municipio",
            "type": "string",
            "order": 9,
            "required": false,
            "description": "Nombre del municipio o ciudad."
          },
          {
            "id": "provincia",
            "label": "Provincia",
            "type": "string",
            "order": 10,
            "required": false,
            "description": "Nombre de la provincia (Provincia)."
          },
          {
            "id": "pais",
            "label": "País",
            "type": "string",
            "order": 11,
            "required": false,
            "description": "Código de país impreso bajo País.",
            "default": "ES"
          },
          {
            "id": "telefono",
            "label": "Número de teléfono",
            "type": "string",
            "order": 12,
            "required": false,
            "description": "Contacto telefónico (Teléfono)."
          },
          {
            "id": "correo_electronico",
            "label": "Dirección de correo electrónico",
            "type": "string",
            "order": 13,
            "required": false,
            "description": "Dirección de correo electrónico (Dirección electrónica)."
          },
          {
            "id": "acuerdo_declaracion",
            "label": "Acuerdo con la declaración",
            "type": "boolean",
            "order": 14,
            "required": false,
            "description": "Casilla 'Sí' que indica que el presentador declara bajo su responsabilidad que la copia simple coincide con el original.",
            "default": true
          },
          {
            "id": "fecha_firma",
            "label": "Fecha de firma",
            "type": "string",
            "order": 15,
            "required": false,
            "description": "Misma fecha la cual se hace el documento, y se genera osea un .today()",
            "format": "YYYY-MM-DD",
            "validation": "Debe ser una fecha válida en formato ISO (YYYY-MM-DD).",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          }
        ]
      },
      {
        "id": "liquidacion",
        "label": "Liquidación (autoliquidación)",
        "order": 5,
        "required": true,
        "fields": [
          {
            "id": "caudal_hereditario_fiscal_caja_1",
            "label": "Caudal hereditario fiscal (caja 1)",
            "type": "number",
            "order": 1,
            "required": false,
            "description": "Importe del caudal hereditario fiscal.",
            "format": "decimal",
            "boxNumber": "1"
          },
          {
            "id": "participacion_contribuyente_caudal_hereditario_caja_2",
            "label": "Participacion del contribuyente en el caudal hereditario (caja 2)",
            "type": "number",
            "order": 2,
            "required": false,
            "description": "Importe de participacion del contribuyente en el caudal hereditario.",
            "format": "decimal",
            "boxNumber": "2"
          },
          {
            "id": "percepciones_seguros_vida_caja_3",
            "label": "Percepciones como beneficiario de seguros de vida (caja 3)",
            "type": "number",
            "order": 3,
            "required": false,
            "description": "Importe de percepciones por seguros de vida.",
            "format": "decimal",
            "boxNumber": "3"
          },
          {
            "id": "bienes_adicionales_base_imponible_caja_4",
            "label": "Bienes adicionales a la base imponible individual (caja 4)",
            "type": "number",
            "order": 4,
            "required": false,
            "description": "Importe de bienes adicionales a la base imponible individual.",
            "format": "decimal",
            "boxNumber": "4"
          },
          {
            "id": "base_imponible_real_caja_5",
            "label": "Base imponible real (caja 5)",
            "type": "number",
            "order": 5,
            "required": false,
            "description": "Base imponible real (2 + 3 + 4).",
            "format": "decimal",
            "boxNumber": "5",
            "calculation": "participacionContribuyenteCaudalHereditarioCaja2 + percepcionesSegurosVidaCaja3 + bienesAdicionalesBaseImponibleCaja4"
          },
          {
            "id": "valor_pleno_dominio_caja_6",
            "label": "Valor del pleno dominio (caja 6)",
            "type": "number",
            "order": 6,
            "required": false,
            "description": "Valor del pleno dominio para bienes en nuda propiedad.",
            "format": "decimal",
            "boxNumber": "6"
          },
          {
            "id": "valor_nuda_propiedad_caja_7",
            "label": "Valor de la nuda propiedad (caja 7)",
            "type": "number",
            "order": 7,
            "required": false,
            "description": "Valor de la nuda propiedad.",
            "format": "decimal",
            "boxNumber": "7"
          },
          {
            "id": "donaciones_acumulables_caja_8",
            "label": "Donaciones acumulables (caja 8)",
            "type": "number",
            "order": 8,
            "required": false,
            "description": "Importe de donaciones acumulables.",
            "format": "decimal",
            "boxNumber": "8"
          },
          {
            "id": "bienes_derechos_exentos_convenios_caja_9",
            "label": "Bienes y derechos exentos por convenios internacionales (caja 9)",
            "type": "number",
            "order": 9,
            "required": false,
            "description": "Importe de bienes y derechos exentos por convenios internacionales.",
            "format": "decimal",
            "boxNumber": "9"
          },
          {
            "id": "base_imponible_teorica_caja_10",
            "label": "Base imponible teorica (caja 10)",
            "type": "number",
            "order": 10,
            "required": false,
            "description": "Base imponible teorica (5 + 6 - 7 + 8 + 9).",
            "format": "decimal",
            "boxNumber": "10",
            "calculation": "baseImponibleRealCaja5 + valorPlenoDominioCaja6 - valorNudaPropiedadCaja7 + donacionesAcumulablesCaja8 + bienesDerechosExentosConveniosCaja9"
          },
          {
            "id": "bonificacion_discapacidad",
            "label": "Bonificación por discapacidad",
            "type": "number",
            "order": 11,
            "required": false,
            "description": "Importe en la línea 'Por discapacidad'.",
            "format": "decimal"
          },
          {
            "id": "cuota_tributaria_caso_general",
            "label": "Cuota tributaria - caso general",
            "type": "number",
            "order": 12,
            "required": false,
            "description": "Cuota tributaria. Caso general (si 5 = 10).",
            "format": "decimal"
          },
          {
            "id": "tipo_medio_efectivo_cuota_tributaria",
            "label": "Cuota tributaria - tipo medio efectivo",
            "type": "number",
            "order": 13,
            "required": false,
            "description": "Cuota tributaria. Tipo medio efectivo (si 5 ≠ 10).",
            "format": "decimal"
          },
          {
            "id": "base_liquidable_real_caja_13",
            "label": "Base liquidable real (caja 13)",
            "type": "number",
            "order": 14,
            "required": false,
            "description": "Base liquidable real mostrada en la caja 13.",
            "format": "decimal",
            "boxNumber": "13",
            "calculation": "baseBrutaReal - total_reducciones_real_caja_11"
          },
          {
            "id": "base_liquidable_teorica_caja_14",
            "label": "Base liquidable teórica (caja 14)",
            "type": "number",
            "order": 15,
            "required": false,
            "description": "Base liquidable teórica mostrada en la caja 14.",
            "format": "decimal",
            "boxNumber": "14",
            "calculation": "baseBrutaTeorica - total_reducciones_teorica_caja_12"
          },
          {
            "id": "cuota_integra_caja_16",
            "label": "Cuota íntegra (caja 16)",
            "type": "number",
            "order": 16,
            "required": false,
            "description": "Cuota íntegra calculada para la caja 16.",
            "format": "decimal",
            "boxNumber": "16"
          },
          {
            "id": "cuota_tributaria_caja_605",
            "label": "Cuota tributaria (caja 605)",
            "type": "number",
            "order": 17,
            "required": false,
            "description": "Cuota tributaria antes de reducciones (caja 605).",
            "format": "decimal",
            "boxNumber": "605"
          },
          {
            "id": "reduccion_exceso_cuota_caja_606",
            "label": "Reducción por exceso de cuota (caja 606)",
            "type": "number",
            "order": 18,
            "required": false,
            "description": "Reducción por exceso de cuota.",
            "format": "decimal",
            "boxNumber": "606"
          },
          {
            "id": "cuota_tributaria_ajustada_caja_607",
            "label": "Cuota tributaria ajustada (caja 607)",
            "type": "number",
            "order": 19,
            "required": false,
            "description": "Cuota ajustada 605 - 606.",
            "format": "decimal",
            "boxNumber": "607",
            "calculation": "cuotaTributariaCaja605 - reduccionExcesoCuotaCaja606"
          },
          {
            "id": "tipo_medio_efectivo_caja_17",
            "label": "Tipo medio efectivo (caja 17)",
            "type": "number",
            "order": 20,
            "required": false,
            "description": "Tipo medio efectivo 607 / 14 x 100.",
            "format": "decimal",
            "boxNumber": "17",
            "calculation": "cuotaTributariaAjustadaCaja607 / baseLiquidableTeoricaCaja14 * 100"
          },
          {
            "id": "cuota_tributaria_ajustada_caja_18",
            "label": "Cuota tributaria ajustada (caja 18)",
            "type": "number",
            "order": 21,
            "required": false,
            "description": "Cuota tributaria ajustada mostrada en la caja 18.",
            "format": "decimal",
            "boxNumber": "18",
            "calculation": "baseLiquidableRealCaja13 * tipoMedioEfectivoCaja17 / 100"
          },
          {
            "id": "bonificacion_cuota_caja_19",
            "label": "Bonificación de la cuota tributaria (caja 19)",
            "type": "number",
            "order": 22,
            "required": false,
            "description": "Bonificación de la cuota tributaria.",
            "format": "decimal",
            "boxNumber": "19"
          },
          {
            "id": "deduccion_doble_imposicion_caja_20",
            "label": "Deducción por doble imposición (caja 20)",
            "type": "number",
            "order": 23,
            "required": false,
            "description": "Deducción por doble imposición internacional.",
            "format": "decimal",
            "boxNumber": "20"
          },
          {
            "id": "deduccion_cuotas_anteriores_caja_21",
            "label": "Deducción de cuotas anteriores (caja 21)",
            "type": "number",
            "order": 24,
            "required": false,
            "description": "Deducción de cuotas anteriores.",
            "format": "decimal",
            "boxNumber": "21"
          },
          {
            "id": "cuota_ingresar_caja_22",
            "label": "Importe a ingresar (caja 22)",
            "type": "number",
            "order": 25,
            "required": false,
            "description": "Cuota a pagar: 18 - 19 - 20 - 21.",
            "format": "decimal",
            "boxNumber": "22",
            "calculation": "cuotaTributariaAjustadaCaja18 - bonificacionCuotaCaja19 - deduccionDobleImposicionCaja20 - deduccionCuotasAnterioresCaja21"
          },
          {
            "id": "recargo_caja_23",
            "label": "Recargo (caja 23)",
            "type": "number",
            "order": 26,
            "required": false,
            "description": "Recàrrec aplicado al importe a ingresar.",
            "format": "decimal",
            "boxNumber": "23"
          },
          {
            "id": "intereses_demora_caja_24",
            "label": "Intereses de demora (caja 24)",
            "type": "number",
            "order": 27,
            "required": false,
            "description": "Intereses de demora.",
            "format": "decimal",
            "boxNumber": "24"
          },
          {
            "id": "total_ingresar_caja_25",
            "label": "Importe total a ingresar (caja 25)",
            "type": "number",
            "order": 28,
            "required": false,
            "description": "Total a ingresar = 22 + 23 + 24.",
            "format": "decimal",
            "boxNumber": "25",
            "calculation": "cuotaIngresarCaja22 + recargoCaja23 + interesesDemoraCaja24"
          },
          {
            "id": "es_liquidacion_parcial",
            "label": "Liquidacion parcial",
            "type": "boolean",
            "order": 29,
            "required": false,
            "description": "Marca si se trata de una liquidacion parcial."
          },
          {
            "id": "es_liquidacion_complementaria",
            "label": "Liquidacion complementaria",
            "type": "boolean",
            "order": 30,
            "required": false,
            "description": "Marca si se trata de una liquidacion complementaria."
          },
          {
            "id": "numero_ultima_autoliquidacion",
            "label": "Numero de la ultima autoliquidacion",
            "type": "string",
            "order": 31,
            "required": false,
            "description": "Numero de referencia de la autoliquidacion anterior."
          },
          {
            "id": "fecha_presentacion_liquidacion",
            "label": "Fecha de presentacion",
            "type": "string",
            "order": 32,
            "required": false,
            "description": "Fecha de presentacion de la autoliquidacion anterior.",
            "format": "YYYY-MM-DD",
            "validationRegex": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          {
            "id": "cuota_ingresada",
            "label": "Cuota ingresada",
            "type": "number",
            "order": 33,
            "required": false,
            "description": "Cuota ingresada en la autoliquidacion anterior.",
            "format": "decimal"
          }
        ]
      },
      {
        "id": "reducciones",
        "label": "Reducciones de la base imponible",
        "order": 6,
        "required": false,
        "type": "array",
        "description": "Lista de reducciones aplicables a la base imponible. Cada reducción tiene un importe real (casillas 301-312) y teórico (casillas 401-412).",
        "fields": {
          "casillaReal": {
            "label": "Casilla reducción real (301-312)",
            "type": "integer",
            "required": true,
            "description": "Número de casilla en la columna de reducción real (rango 301-312).",
            "validation": "Debe ser un número entre 301 y 312."
          },
          "casillaTeorica": {
            "label": "Casilla reducción teórica (401-412)",
            "type": "integer",
            "required": true,
            "description": "Número de casilla en la columna de reducción teórica (rango 401-412).",
            "validation": "Debe ser un número entre 401 y 412."
          },
          "tipo_reduccion": {
            "label": "Tipo de reducción",
            "type": "string",
            "required": true,
            "description": "Tipo de reducción (enum).",
            "values": [
              "por_parentesco",
              "por_discapacidad",
              "para_personas_mayores",
              "por_imposicion_decenal",
              "por_seguros_vida",
              "por_actividad_empresarial_profesional",
              "por_participacion_entidades",
              "por_vivienda_habitual",
              "por_bienes_interes_cultural",
              "por_explotaciones_agrarias",
              "por_fincas_rusticas_forestales",
              "otras_reducciones"
            ]
          },
          "importeReal": {
            "label": "Importe reducción real",
            "type": "number",
            "required": false,
            "description": "Importe aplicado sobre la base real (se muestra en la casillaReal 301-312).",
            "format": "decimal",
            "default": 0.0
          },
          "importeTeorico": {
            "label": "Importe reducción teórica",
            "type": "number",
            "required": false,
            "description": "Importe aplicado sobre la base teórica (se muestra en la casillaTeorica 401-412).",
            "format": "decimal",
            "default": 0.0
          }
        }
      },
      {
        "id": "totalesReducciones",
        "label": "Totales de reducciones",
        "order": 7,
        "required": false,
        "fields": [
          {
            "id": "total_reducciones_real_caja_11",
            "label": "Total reducciones real (caja 11)",
            "type": "number",
            "order": 1,
            "required": false,
            "description": "Suma total de todas las reducciones reales (casillas 301-312).",
            "format": "decimal",
            "boxNumber": "11",
            "calculation": "sum(reducciones.importeReal)",
            "validation": "Debe coincidir con la suma de todas las reducciones.importeReal."
          },
          {
            "id": "total_reducciones_teorica_caja_12",
            "label": "Total reducciones teórica (caja 12)",
            "type": "number",
            "order": 2,
            "required": false,
            "description": "Suma total de todas las reducciones teóricas (casillas 401-412).",
            "format": "decimal",
            "boxNumber": "12",
            "calculation": "sum(reducciones.importeTeorico)",
            "validation": "Debe coincidir con la suma de todas las reducciones.importeTeorico."
          },
          {
            "id": "total_reducciones_aplicadas",
            "label": "Total reducciones aplicadas",
            "type": "number",
            "order": 3,
            "required": false,
            "description": "Total de reducciones aplicadas (normalmente igual a total_reducciones_real_caja_11 si se usa base real).",
            "format": "decimal",
            "calculation": "total_reducciones_real_caja_11 o total_reducciones_teorica_caja_12 según corresponda"
          }
        ]
      }
    ],
    "notes": {
      "ordering": "Las secciones y campos siguen el diseño ATC-650E-6 para que los componentes de la interfaz puedan consumir este JSON secuencialmente.",
      "boxMapping": "Las referencias a las cajas 11-25 y 301-312 (real), 401-412 (teórica) y 605-607 coinciden con la numeración impresa en el formulario de la administración catalana.",
      "validations": {
        "codigoPostal": "Regex: ^\\d{5}$",
        "nif": "Formato DNI/NIE/CIF válido",
        "fecha": "Formato ISO YYYY-MM-DD",
        "sumas": "sum(reducciones.importeReal) === totalesReducciones.total_reducciones_real_caja_11 y sum(reducciones.importeTeorico) === totalesReducciones.total_reducciones_teorica_caja_12",
        "baseLiquidable": "Si total_reducciones_real_caja_11 > 0, recalcular baseLiquidableRealCaja13 = baseBrutaReal - total_reducciones_real_caja_11"
      },
      "idNaming": "Los IDs de campos no incluyen prefijos de sección ya que el contexto se determina por la sección padre. Los nombres siguen snake_case para coincidir con los campos de la base de datos."
    }
  }
}